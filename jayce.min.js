!function(n,r){"function"==typeof define?define(r):"object"==typeof module&&"object"==typeof module.exports?module.exports=r():n.jayce=r()}(this,function(){function n(n,r){var e=0,t=n.length;if(t)for(;t>e;)r(n[e],e++);else for(var u in n)r(n[u],u);return n}function r(n){return n.replace(/\s/g,"")}function e(n){return String(n).replace(/("|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}function t(n){return v[n]}function u(n){return String(n).replace(/&(?![\w#]+;)|[<>"']/g,t)}function c(e,t){function u(n){return"_out+="+n+";"}function c(n){var r=n.split(","),e=r[0];t.push(e);var u=r[1],c=r[2];return"_$.forEach("+e+", function("+u+","+c+"){"}function i(r){var e,u=r.split(/\|+/);return n(u,function(n,r){0===r?(e=n,t.push(n.split(".")[0])):e="_$$."+n+"("+e+")"}),e}if(3===e.length){var a="",o=r(e[0]),f=e[1],s=e[2];switch(f){case"$":"#"===o.charAt(0)?(o=o.substr(1),a=u(i(o))):a=u("_$.escape("+i(o)+")");break;case"?":n(o.match(g),function(n){/\./.test(n)||t.push(n)}),a="if("+o+"){";break;case":?":a=o?"}else if("+o+"){":"}else{";break;case"/?":a="}";break;case"@":a=c(o);break;case"/@":a="});"}return a+=u('"'+s+'"')}return u('"'+e[0]+'"')}function i(n){return function(r){return n(r,l,p)}}function a(r){if(s[r])return s[r];r=e(r);var t="",u=[];n(r.split(h),function(n){n=n.split($),t+=c(n,u)});var a='var _out="";';n(u,function(n){a+="var "+n+"=data."+n+";"}),t=a+t+"return _out;";var o=new Function("data","_$","_$$",t);return s[r]=i(o)}function o(n,r){return a(n)(r)}function f(n,r){return p[n]=r,this}var s={},p={},l={};l.forEach=n;var v={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};l.escape=u;var g=/\.?(?!\d)[\d\w_$]+/g,h=/\{/g,$=/((?:\/|:)?[$?!@-])\}/g;return{compile:a,render:o,filter:f}});